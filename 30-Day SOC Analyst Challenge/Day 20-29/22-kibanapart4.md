# Day 22: Creating Alerts and Dashboards in Kibana
## Objective
In this section, I'll create an alert and dashboard based on the telemetry generated by Mythic.

## Steps
If you remember, last section, I performed a brute force attack and established a command and control session. To do this, I had to install and run a payload on the target Windows computer. This process creation can be viewed within our Elasticsearch logs, and that's what we'll be doing in this section. 

<p align="center"><img src="https://i.imgur.com/4Q4R4dt.png"></p>
<p align="center"><i>Ref 1: Searching for the process creations of the payload that let us establish a C2 session.</i></p>
<br>

With the query `event.code: 1 and (winlog.event_data.Hashes: *FF65AE48B9572FE896BC6656FD0921E5E1A89C7D932446F02F0C62DA14D26343* or winlog.event_data.OriginalFileName: "Apollo.exe")`, I'm going to make a new rule.

<p align="center"><img src="https://i.imgur.com/Wr7Haf1.png"></p>
<p align="center"><i>Ref 2: Setting the rule's required fields.</i></p>
<br>

<p align="center"><img src="https://i.imgur.com/7rkXYyz.png"></p>
<p align="center"><i>Ref 3: Our rule has been created.</i></p>
<br>

This query: `event.code: 1 and event.provider:  "Microsoft-Windows-Sysmon"  and (powershell or cmd or rundll32)` finds event creations that Sysmon picked up on and sent over to us.  

After making the rule, we can start making our dashboard to help us visualize the rule we just created. 

<p align="center"><img src="https://i.imgur.com/kVbpCc9.png"></p>
<p align="center"><i>Ref 4: Our first table has been created. It focuses on process creations (event ID 1).</i></p>
<br>

This table looks at process creations, but we also want to look at exterbak network connections as well. To do this, I'll use this query: `event.code: 3 and event.provider: "Microsoft-Windows-Sysmon" and winlog.event_data.Initiated: "true" and not winlog.event_data.Image: *MsMpEng.exe`.

To filter for Microsoft Defender deactivations, I'll use this query: `event.code: 5001 and event.provider : "Microsoft-Windows-Windows Defender"`.

With these three queries, I can make my fully fleshed-out dashboard.

<p align="center"><img src="https://i.imgur.com/9mnEA7i.png"></p>
<p align="center"><i>Ref 5: Our three tables have been added to our dashboard.</i></p>
<br>

## Summary
In this section, I created three alerts and three dashboards for process creations, intiated network connections, and Microsoft Defender deactivations.
